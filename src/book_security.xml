<?xml version="1.0" encoding="UTF-8"?>
<book xmlns="http://docbook.org/ns/docbook"
      xmlns:its="http://www.w3.org/2005/11/its"
      xmlns:xi="http://www.w3.org/2001/XInclude"
      xmlns:xlink="http://www.w3.org/1999/xlink"
      version="5.2"
      xml:lang="en"
      xml:id="book-security">
   <info>
      <title>Security and Hardening Guide</title>
      <productname>
         <phrase role="productname">SUSE Linux Enterprise Server</phrase>
      </productname>
      <productnumber>
         <phrase role="productnumber">15 SP7</phrase>
      </productnumber>
      <date><?dbtimestamp format="B d, Y"?></date>
      <!-- This file is part of the project https://github.com/openSUSE/doc-kit -->
      <!-- DO NOT EDIT THIS FILE DOWNSTREAM. IT MAY BE OVERWRITTEN BY AN UPDATE. -->
      <xi:include href="common_copyright_gfdl.xml"/>
      <abstract>
         <para>This guide introduces basic concepts of system security and describes the usage of security software included with the product, such as AppArmor, SELinux, or the auditing system. The guide also supports system administrators in hardening an installation.</para>
      </abstract>
      <meta name="title">Security and Hardening Guide</meta>
      <meta name="series">Products &amp; Solutions</meta>
      <meta name="description">How to implement system security and hardening using the security software included with the product</meta>
      <meta name="social-descr">Implement system security and hardening for <phrase role="productname">SLES</phrase>
      </meta>
      <meta name="task">Auditing Security</meta>
      <revhistory xml:id="rh-book-security">
         <revision>
            <date>2025-06-17</date>
            <revdescription>
               <para>Updated for the initial release of <phrase role="productname">SUSE Linux Enterprise Server</phrase><phrase role="productnumber">15 SP7</phrase>.</para>
            </revdescription>
         </revision>
      </revhistory>
   </info>
   <xi:include href="security_intro.xml"/>
   <xi:include href="security_preface.xml"/>
   <part xml:id="part-auth">
      <title>Authentication</title>
      <xi:include href="security_pam.xml"/>
      <xi:include href="security_nis.xml"/>
      <xi:include href="security_auth.xml"/>
      <xi:include href="security_ldap.xml"/>
      <xi:include href="security_kerberos.xml"/>
      <xi:include href="security_ad_support.xml"/>
      <xi:include href="security_freeradius.xml"/>
   </part>
   <part xml:id="part-local-security">
      <title>Local security</title>
      <xi:include href="physical_security.xml"/>
      <xi:include href="software_management.xml"/>
      <xi:include href="file_management.xml"/>
      <xi:include href="security_cryptofs.xml"/>
      <xi:include href="security_cryptctl.xml"/>
      <xi:include href="user_management.xml"/>
      <xi:include href="security_cron_at.xml"/>
      <xi:include href="security_spectre_meltdown_checker.xml"/>
      <xi:include href="security_yast2_security.xml"/>
      <xi:include href="security_polkit.xml"/>
      <xi:include href="security_acls.xml"/>
      <!-- this is very outdated, removing until I can rewrite
  it with updated information cschroder 12 Dec 2021
  <xi:include href="security_certificatestore.xml"/>-->
      <xi:include href="security_aide.xml"/>
   </part>
   <part xml:id="part-network-security">
      <title>Network security</title>
      <xi:include href="security_xforwarding.xml"/>
      <xi:include href="security_ssh.xml"/>
      <xi:include href="security_firewall.xml"/>
      <!--
 * openVPN Howto
   http://openvpn.net/index.php/documentation/howto.html

 * OpenVPN Tutorial (German)
   https://web.archive.org/web/20120424181239/http://www.pronix.de/pronix-935.html

 * OpenVPN-Wiki (German)
   http://wiki.openvpn.eu/index.php/Hauptseite

 * http://qam.suse.de/testreports/SUSE:Maintenance:219:46941/recommended-reading.txt

 Contact:
 - Marius Tomaschewski <mt@suse.de>

-->
      <xi:include href="security_vpnserver.xml"/>
      <xi:include href="security_xca.xml"/>
      <xi:include href="security_sysctl.xml"/>
   </part>
   <part xml:id="part-compliance">
      <title>Regulations and compliance</title>
      <xi:include href="common_criteria.xml"/>
      <xi:include href="security_fips.xml"/>
      <!-- Moved to SUSE/doc-unversioned  Feb 23 2022 cschroder-->
      <xi:include href="security_pcidss.xml"/>
      <xi:include href="security_stig.xml"/>
   </part>
   <part xml:id="part-apparmor">
      <title>Confining privileges with AppArmor</title>
      <xi:include href="apparmor_intro.xml"/>
      <xi:include href="apparmor_start.xml"/>
      <!-- fs 2009-02-25: Todo Code 11:

* split Chapter 2 (apparmor_profiles.xml) into:
  - basic profile (basic file rules, and profile syntax)
  - advanced (all the newer stuff, owner rules, link pairs,
    unattached profiles, ...)
* External Local Profiles and Hats (in appendix?)
* /sys/kernel/security/apparmor/matching (for scripts):
  pattern=aadfa audit perms=rwxamlk/ user::other

  pattern=aadfa - means the matching is done by the aadfa engine, the old
                engine was individual rule based on pcre.  The aadfa
                engine is a lot faster and cleaner kernel side but
                requires the user side to do significantly more work
                setting things up.

                This tells the parser which set of routines to use.
  audit - means that rule auditing and quieting is supported
  perms=rwxamlk/ - is the list of perms supported.  / means that directory
                 are match by trailing / in policy.  This wasn't the
                 case pre AppArmor 2.1 (opensuse 10.3).
                 10.3 perms string looks like
                     pattern=aadfa perms=rwxamlz
                 the z is a bug it is supposed to be k, but it was also
                 had another bug because it was missing /, so z now = k/
                 to the tools.

                 if you look at SP2 perms it will look like
                    pattern=aadfa perms=rwxml
                 because it doesn't support everything that 10.3 does

  user::other - indicates the permission are support for both user and
              other matching.  Internally AA does something very similar
              to unix dac permission checking of user, group, other,
              except AA's is user, extended user acl, other.

              owner rules set the user set, none owner rules set the
              user and other set.  By the way it is actually possible to
              write an other rule.

                 other /bin/foo r,   # only matches files not owned by
                                       the user, nor matched by extended
                                       owner checks.
              But the syntax isn't set in stone yet, and I didn't add
              support to the tools yet.

              The extended permission acl (which replaces unix group
              check) will allow for specifying who the file is owned by.

                 owner=root /bin/foo rw,  # only allow access if the
                                            file is owned by root.

* the ability to drop/migrate events out of the events db
* mount rules (implemented)?

-->
      <xi:include href="apparmor_whatimmunize.xml"/>
      <xi:include href="apparmor_profiles.xml"/>
      <xi:include href="apparmor_repositories.xml"/>
      <xi:include href="apparmor_profiles_yast.xml"/>
      <xi:include href="apparmor_profiles_man.xml"/>
      <xi:include href="apparmor_changehat.xml"/>
      <xi:include href="apparmor_pam.xml"/>
      <xi:include href="apparmor_managing.xml"/>
      <xi:include href="apparmor_support.xml"/>
      <xi:include href="apparmor_glossary.xml"/>
   </part>
   <part xml:id="part-selinux">
      <title>SELinux</title>
      <xi:include href="selinux.xml"/>
   </part>
   <part xml:id="part-audit">
      <title>The Linux Audit Framework</title>
      <xi:include href="audit_components.xml"/>
      <xi:include href="audit_setup.xml"/>
      <xi:include href="audit_scenarios.xml"/>
      <xi:include href="audit_moreinfo.xml"/>
   </part>
   <!-- ===================================================================== -->
   <!-- Appendixes                                                            -->
   <!-- ===================================================================== -->
   <!-- This file is part of the project https://github.com/openSUSE/doc-kit -->
   <!-- DO NOT EDIT THIS FILE DOWNSTREAM. IT MAY BE OVERWRITTEN BY AN UPDATE. -->
   <xi:include href="common_legal.xml"/>
</book>
